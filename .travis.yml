language: rust

sudo: required

addons:
  apt:
    packages:
      - libcurl4-openssl-dev
      - libelf-dev
      - libdw-dev
      - cmake
      - gcc
      - binutils-dev
      - libiberty-dev

matrix:
  include:

    # GNU/Linux - Rust Beta Build
    - env: TARGET=x86_64-unknown-linux-gnu DISABLE_TESTS=1
      name: Cargo Build
      rust: stable
      script: cargo build --verbose --all

    # GNU/Linux - Rust Stable Test
    - env: TARGET=x86_64-unknown-linux-gnu
      name: Cargo Test
      rust: stable
      script: ./test.sh

cache: cargo
before_cache:
  - chmod -R a+r $HOME/.cargo

before_script:
  - rustup self update
  - source ~/.cargo/env || true

after_success: |
  echo "@TODO"
